<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layoutSecretaria}">

<head>
	<title>Lista de Especialidades</title>
	<!-- Bootstrap & Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

	<!-- DataTables CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
	<link rel="stylesheet" href="/css/index-medico.css">
</head>

<body>
	<div layout:fragment="content">
		<div class="container py-4 rounded-3">
			<h1 class="text-center text-dark fw-bold mb-4">Lista de Especialidad</h1>

			<!-- FILTRO Y BOTÓN AGREGAR alineados con la tabla -->
			<div class="container mb-3 px-0" style="max-width: 950px;">
				<div class="row g-2">
					<!-- Filtro -->
					<div class="col-12 col-md-8 d-flex flex-wrap gap-2">
						<select id="filtroTipo" class="form-select form-select-sm w-auto">
						    <option value="codigo">Código</option>
						    <option value="especialidad">Especialidad</option>
						</select>
						<input type="text" id="buscarInput" class="form-control form-control-sm w-50" placeholder="Buscar...">
					</div>

					<!-- Botón Agregar -->
					<div class="col-12 col-md-4 text-md-end text-center">
						<button type="button" class="btn btn-success w-auto px-3 py-1.5" data-bs-toggle="modal"
							data-bs-target="#modalRegistrarEspecialidad">
							<i class="bi bi-plus-circle me-1"></i> Agregar
						</button>
					</div>
				</div>
			</div>


			<!-- TABLA -->
			<div class="d-flex justify-content-center">
				<div class="table-responsive rounded" style="max-width: 950px; width: 100%;">
					<table id="tablaEspecialidad" class="table table-hover table-bordered align-middle text-center">
						<thead class="table-primary">
							<tr>
								<th style="width: 10%;">ID</th>
								<th style="width: 50%;">Especialidad</th> <!-- AUMENTADO -->
								<th style="width: 20%;">Monto</th> <!-- REDUCIDO -->
								<th style="width: 20%;">Acciones</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="especialidad : ${listaEspecialidad}">
								<td th:text="${especialidad.idEspecialidad}"></td>
								<td th:text="${especialidad.especialidad}"></td>
								<td class="monto" th:text="${especialidad.montoPorEspecialidad}"></td>
								<td>
									<div class="d-flex justify-content-center gap-2">
										<a th:href="@{/especialidad/detalleEsp/{id}(id=${especialidad.idEspecialidad})}"
											class="btn btn-outline-secondary btn-sm" title="Ver">
											<i class="bi bi-eye"></i>
										</a>
										<a th:href="@{/especialidad/editarEsp/{id}(id=${especialidad.idEspecialidad})}"
											class="btn btn-outline-primary btn-sm" title="Editar">
											<i class="bi bi-pencil"></i>
										</a>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<!-- Modal Especialidad -->
			<div th:replace="especialidad/registrarEspecialidad :: modalRegistrarEspecialidad"></div>
		</div>
	</div>

	<!-- SCRIPTS -->
	<div layout:fragment="scripts">
		<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
		<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
		<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

		<!-- ✅ Alerta de éxito -->
		<script th:if="${exito != null}" th:inline="javascript">
			let mensaje = /*[[${exito}]]*/ 'Registro exitoso';
			Swal.fire({
				icon: 'success',
				title: '¡Éxito!',
				text: mensaje,
				showConfirmButton: false,
				timer: 2000
			});
		</script>

		<!-- ❌ Alerta de error -->
		<script th:if="${error != null}" th:inline="javascript">
			let mensajeError = /*[[${error}]]*/ 'Error al registrar';
			Swal.fire({
				icon: 'error',
				title: '¡Error!',
				text: mensajeError,
				showConfirmButton: true
			});
		</script>

		<!-- Script especifico de la vista -->
		<script src="/js/index-especialidad.js"></script>
	</div>

	<!-- Bootstrap JS para modales -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>